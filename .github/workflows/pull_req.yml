name: Integration Tests
on: pull_request

jobs:
  integration_tests:
    name: Integration test
    runs-on: ubuntu-latest
    strategy:
      matrix: { program: ['mupdf', 'poppler', 'qpdf''] }

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Build the base image
        run: docker build . --file Dockerfile --tag trailofbits/polytracker --no-cache
      - name: Build the example Docker image
        run: docker build --no-cache examples --file examples/Dockerfile-${{ matrix.program }}.demo --tag trailofbits/polytracker-demo-${{ matrix.program }}